"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[97],{8614:function(e,s,t){t.r(s),t.d(s,{default:function(){return L}});var o=t(3396),a=t(7139),r=t(9242);const l=e=>((0,o.dD)("data-v-877f26b0"),e=e(),(0,o.Cn)(),e),n={class:"Profile maxWidthAndCenter"},d=l((()=>(0,o._)("div",{class:"spaceDivider"},null,-1))),i={class:"headerFlex"},u=["src"],h={class:"passwordBox hide",id:"passwordBox"},p={class:"profileBox"},m=l((()=>(0,o._)("h2",null,"User info:",-1))),w=l((()=>(0,o._)("dt",null,"Username:",-1))),c=l((()=>(0,o._)("dt",null,"E-mail:",-1))),g=l((()=>(0,o._)("h2",null,"Change password",-1))),_={key:0,class:"error",id:"error"},P=l((()=>(0,o._)("label",null,"Old password: ",-1))),v=l((()=>(0,o._)("label",null,"New password: ",-1))),f=l((()=>(0,o._)("label",null,"Repeat new password: ",-1))),I=l((()=>(0,o._)("input",{type:"submit",value:"Update password"},null,-1))),y=l((()=>(0,o._)("br",null,null,-1))),b=l((()=>(0,o._)("hr",null,null,-1))),M=l((()=>(0,o._)("h2",null,"My vibbz",-1)));function E(e,s,l,E,C,S){const U=(0,o.up)("Header"),k=(0,o.up)("PostLayout"),x=(0,o.up)("Message");return(0,o.wg)(),(0,o.iD)("div",n,[(0,o.Wm)(U),d,(0,o._)("div",i,[(0,o._)("h1",null,"Hey, "+(0,a.zw)(C.username)+"!",1),(0,o._)("button",{onClick:s[0]||(s[0]=e=>S.editUser())},[(0,o._)("img",{id:"btnImgOne",src:t(2715)(`./${C.settingsIconImg}.png`)},null,8,u)])]),(0,o._)("section",h,[(0,o._)("div",p,[m,(0,o._)("dl",null,[w,(0,o._)("dd",null,(0,a.zw)(C.username),1),c,(0,o._)("dd",null,(0,a.zw)(C.email),1)])]),(0,o._)("div",null,[g,C.errorMessage?((0,o.wg)(),(0,o.iD)("div",_,[(0,o._)("p",null,(0,a.zw)(C.errorMessage),1)])):(0,o.kq)("",!0),(0,o._)("form",{onSubmit:s[4]||(s[4]=(0,r.iM)((e=>S.updatePassword()),["prevent"]))},[P,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":s[1]||(s[1]=e=>C.oldPassword=e)},null,512),[[r.nr,C.oldPassword]]),v,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=e=>C.newPassword=e)},null,512),[[r.nr,C.newPassword]]),f,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":s[3]||(s[3]=e=>C.repeatPassword=e)},null,512),[[r.nr,C.repeatPassword]]),I],32),y,b])]),(0,o._)("section",null,[M,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(C.postsArr,(e=>((0,o.wg)(),(0,o.j4)(k,{key:e,class:"deleteBtnStyle",postID:e._id,textEl:e.text,usernameEl:e.username,emotionEl:e.emotion,hashtagsEl:e.hashtags,timestampEL:e.timestamp,showDeleteBtn:!0},null,8,["postID","textEl","usernameEl","emotionEl","hashtagsEl","timestampEL"])))),128))]),(0,o.Wm)(x,{theMessage:C.resultMessage,color:C.messageColor,reveal:C.revealStatus},null,8,["theMessage","color","reveal"])])}var C=t(7471),S=t(65),U=t(8810),k=t(6071),x={name:"Profile",components:{Header:C.Z,Footer:S.Z,PostLayout:k.Z,Message:U.Z},data(){return{username:"",email:"",postsArr:{},oldPassword:"",newPassword:"",repeatPassword:"",resultMessage:"",messageColor:"",revealStatus:"none",errorColor:"#f36a6a",settingsIconImg:"iconSettings",errorMessage:""}},methods:{getUserInfo(){const e=sessionStorage.getItem("userID");fetch(`http://localhost:3000/user/${e}`,{method:"GET"}).then((e=>{e.json().then((e=>{this.username=e.username,this.email=e.email}))})),fetch(`http://localhost:3000/posts/${e}`,{method:"GET"}).then((e=>{e.json().then((e=>{this.postsArr=e}))}))},getImgUrl(e){var s=t(9861);return s("./"+e+".png")},editUser(){var e=document.getElementById("passwordBox");e.classList.contains("hide")?(this.settingsIconImg="iconClose",e.classList.remove("hide")):(this.settingsIconImg="iconSettings",e.classList.add("hide")),this.oldPassword="",this.newPassword="",this.repeatPassword=""},updatePassword(){const e=sessionStorage.getItem("userID");if(this.newPassword===this.repeatPassword){const s={oldPassword:this.oldPassword,newPassword:this.newPassword};fetch(`http://localhost:3000/user/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((e=>{e.json().then((s=>{if(e.ok){this.settingsIconImg="iconSettings",this.resultMessage="Password is updated",this.messageColor="#c6ddc4",this.revealStatus="block",setTimeout((()=>{this.resultMessage="",this.messageColor="white",this.revealStatus="none"}),3e3);var t=document.getElementById("passwordBox");t.classList.toggle("hide")}else this.errorMessage=s.message}))}))}else this.errorMessage="New password dont match"}},beforeMount(){this.getUserInfo()}},D=t(89);const B=(0,D.Z)(x,[["render",E],["__scopeId","data-v-877f26b0"]]);var L=B}}]);
//# sourceMappingURL=Profile.a1bbc429.js.map