"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[97],{6430:function(e,s,t){t.r(s),t.d(s,{default:function(){return j}});var o=t(3396),l=t(7139),a=t(9242),r=t(745),n=t(6769);const d=e=>((0,o.dD)("data-v-7809b3a8"),e=e(),(0,o.Cn)(),e),i={class:"Profile maxWidthAndCenter"},u=d((()=>(0,o._)("div",{class:"spaceDivider"},null,-1))),h={class:"headerFlex"},m=d((()=>(0,o._)("img",{src:r,alt:"",id:"btnOpen",title:"Edit password"},null,-1))),p=d((()=>(0,o._)("img",{src:n,alt:"",id:"btnClose",class:"hide",title:"Close edit mode"},null,-1))),w=[m,p],c={class:"passwordBox hide",id:"passwordBox"},g={class:"profileBox"},_=d((()=>(0,o._)("h2",null,"Info:",-1))),P=d((()=>(0,o._)("dt",null,"Username:",-1))),v=d((()=>(0,o._)("dt",null,"E-mail:",-1))),b=d((()=>(0,o._)("p",{class:"error",id:"error"},null,-1))),f=d((()=>(0,o._)("label",null,"Old password: ",-1))),y=d((()=>(0,o._)("label",null,"New password: ",-1))),C=d((()=>(0,o._)("label",null,"Repeat new password: ",-1))),E=d((()=>(0,o._)("input",{type:"submit",value:"Update password"},null,-1))),I=d((()=>(0,o._)("br",null,null,-1))),M=d((()=>(0,o._)("hr",null,null,-1))),S=d((()=>(0,o._)("h2",null,"My vibbz",-1)));function B(e,s,t,r,n,d){const m=(0,o.up)("Header"),p=(0,o.up)("PostLayout"),B=(0,o.up)("Message");return(0,o.wg)(),(0,o.iD)("div",i,[(0,o.Wm)(m),u,(0,o._)("div",h,[(0,o._)("h1",null,"Hey, "+(0,l.zw)(n.username)+"!",1),(0,o._)("button",{onClick:s[0]||(s[0]=e=>d.editUser())},w)]),(0,o._)("section",c,[(0,o._)("section",g,[_,(0,o._)("dl",null,[P,(0,o._)("dd",null,(0,l.zw)(n.username),1)]),(0,o._)("dl",null,[v,(0,o._)("dd",null,(0,l.zw)(n.email),1)])]),b,(0,o._)("form",{onSubmit:s[4]||(s[4]=(0,a.iM)((e=>d.updatePassword()),["prevent"]))},[f,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":s[1]||(s[1]=e=>n.oldPassword=e)},null,512),[[a.nr,n.oldPassword]]),y,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":s[2]||(s[2]=e=>n.newPassword=e)},null,512),[[a.nr,n.newPassword]]),C,(0,o.wy)((0,o._)("input",{type:"password","onUpdate:modelValue":s[3]||(s[3]=e=>n.repeatPassword=e)},null,512),[[a.nr,n.repeatPassword]]),E],32),I,M]),(0,o._)("section",null,[S,((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.postsArr,(e=>((0,o.wg)(),(0,o.j4)(p,{key:e,class:"deleteBtnStyle",postID:e._id,textEl:e.text,usernameEl:e.username,emotionEl:e.emotion,hashtagsEl:e.hashtags,timestampEL:e.timestamp,showDeleteBtn:!0},null,8,["postID","textEl","usernameEl","emotionEl","hashtagsEl","timestampEL"])))),128))]),(0,o.Wm)(B,{theMessage:n.resultMessage,color:n.messageColor,reveal:n.revealStatus},null,8,["theMessage","color","reveal"])])}var k=t(7471),x=t(65),U=t(8810),D=t(3481),L={name:"Profile",components:{Header:k.Z,Footer:x.Z,PostLayout:D.Z,Message:U.Z},data(){return{username:"",email:"",postsArr:{},oldPassword:"",newPassword:"",repeatPassword:"",resultMessage:"",messageColor:"",revealStatus:"none",errorColor:"#f36a6a"}},methods:{getUserInfo(){const e=sessionStorage.getItem("userID");fetch(`http://localhost:3000/user/${e}`,{method:"GET"}).then((e=>{e.json().then((e=>{this.username=e.username,this.email=e.email}))})),fetch(`http://localhost:3000/posts/${e}`,{method:"GET"}).then((e=>{e.json().then((e=>{this.postsArr=e}))}))},getImgUrl(e){var s=t(9861);return s("./"+e+".png")},editUser(){var e=document.getElementById("passwordBox");e.classList.toggle("hide");e=document.getElementById("btnClose");e.classList.toggle("hide");e=document.getElementById("btnOpen");e.classList.toggle("hide"),this.oldPassword="",this.newPassword="",this.repeatPassword=""},updatePassword(){document.getElementById("error").innerHTML="";const e=sessionStorage.getItem("userID");if(this.newPassword===this.repeatPassword){const s={oldPassword:this.oldPassword,newPassword:this.newPassword};fetch(`http://localhost:3000/user/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}).then((e=>{e.json().then((s=>{if(e.ok){console.log(s.message),this.resultMessage="Password is updated",this.messageColor="#c6ddc4",this.revealStatus="block",setTimeout((()=>{this.resultMessage="",this.messageColor="white",this.revealStatus="none"}),3e3);var t=document.getElementById("passwordBox");t.classList.toggle("hide")}else this.resultMessage=s.message,this.messageColor=this.errorColor,this.revealStatus="block",setTimeout((()=>{this.resultMessage="",this.messageColor="white",this.revealStatus="none"}),3e3)}))}))}else this.resultMessage="New password dont match",this.messageColor=this.errorColor,this.revealStatus="block",setTimeout((()=>{this.resultMessage="",this.messageColor="white",this.revealStatus="none"}),3e3)}},beforeMount(){this.getUserInfo()}},T=t(89);const H=(0,T.Z)(L,[["render",B],["__scopeId","data-v-7809b3a8"]]);var j=H}}]);
//# sourceMappingURL=Profile.4845ee1f.js.map